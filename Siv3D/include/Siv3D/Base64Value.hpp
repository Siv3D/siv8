//-----------------------------------------------
//
//	This file is part of the Siv3D Engine.
//
//	Copyright (c) 2008-2024 Ryo Suzuki
//	Copyright (c) 2016-2024 OpenSiv3D Project
//
//	Licensed under the MIT License.
//
//-----------------------------------------------

# pragma once
# include "String.hpp"
# include "Unicode.hpp"

namespace s3d
{
	class Blob;

	////////////////////////////////////////////////////////////////
	//
	//	Base64Value
	//
	////////////////////////////////////////////////////////////////

	class Base64Value
	{
	public:

		////////////////////////////////////////////////////////////////
		//
		//	(constructor)
		//
		////////////////////////////////////////////////////////////////

		[[nodiscard]]
		Base64Value() = default;

		[[nodiscard]]
		explicit constexpr Base64Value(const char8* base64);

		[[nodiscard]]
		explicit constexpr Base64Value(std::string_view base64);

		[[nodiscard]]
		explicit constexpr Base64Value(const std::string& base64);

		[[nodiscard]]
		explicit constexpr Base64Value(std::string&& base64);

		[[nodiscard]]
		explicit Base64Value(StringView base64);

		////////////////////////////////////////////////////////////////
		//
		//	getBase64
		//
		////////////////////////////////////////////////////////////////

		[[nodiscard]]
		constexpr const std::string& getBase64() const noexcept;

		////////////////////////////////////////////////////////////////
		//
		//	isEmpty
		//
		////////////////////////////////////////////////////////////////

		[[nodiscard]]
		constexpr bool isEmpty() const noexcept;

		////////////////////////////////////////////////////////////////
		//
		//	operator bool
		//
		////////////////////////////////////////////////////////////////

		[[nodiscard]]
		constexpr explicit operator bool() const noexcept;

		////////////////////////////////////////////////////////////////
		//
		//	maxBinarySize
		//
		////////////////////////////////////////////////////////////////

		[[nodiscard]]
		size_t maxBinarySize() const noexcept;

		////////////////////////////////////////////////////////////////
		//
		//	toBinary
		//
		////////////////////////////////////////////////////////////////

		[[nodiscard]]
		bool toBinary(void* dst) const;

		////////////////////////////////////////////////////////////////
		//
		//	toBlob
		//
		////////////////////////////////////////////////////////////////

		[[nodiscard]]
		bool toBlob(Blob& dst) const;

		[[nodiscard]]
		Blob toBlob() const;

		////////////////////////////////////////////////////////////////
		//
		//	toFile
		//
		////////////////////////////////////////////////////////////////

		/// @brief Base64 値をデコードした結果をファイルに保存します。
		/// @param path 保存先のファイルパス
		/// @return 保存に成功した場合 true, それ以外の場合は false
		[[nodiscard]]
		bool toFile(FilePathView path) const;

		////////////////////////////////////////////////////////////////
		//
		//	FromBinary
		//
		////////////////////////////////////////////////////////////////

		/// @brief バイナリデータから Base64 値を作成します。
		/// @param src バイナリデータの先頭ポインタ
		/// @param size バイナリデータのサイズ（バイト）
		/// @return 作成された Base64 値
		[[nodiscard]]
		static Base64Value FromBinary(const void* src, size_t size);

		////////////////////////////////////////////////////////////////
		//
		//	FromBlob
		//
		////////////////////////////////////////////////////////////////

		/// @brief Blob から Base64 値を作成します。
		/// @param blob Blob
		/// @return 作成された Base64 値
		[[nodiscard]]
		static Base64Value FromBlob(const Blob& blob);

		////////////////////////////////////////////////////////////////
		//
		//	FromFile
		//
		////////////////////////////////////////////////////////////////

		/// @brief ファイルの内容から Base64 値を作成します。
		/// @param path ファイルパス
		/// @return 作成された Base64 値
		[[nodiscard]]
		static Base64Value FromFile(FilePathView path);

	private:

		std::string m_base64;
	};
}

# include "detail/Base64Value.ipp"
